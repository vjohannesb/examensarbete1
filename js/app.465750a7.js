(function(e){function t(t){for(var o,r,s=t[0],l=t[1],i=t[2],d=0,b=[];d<s.length;d++)r=s[d],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&b.push(a[r][0]),a[r]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);u&&u(t);while(b.length)b.shift()();return c.push.apply(c,i||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],o=!0,s=1;s<n.length;s++){var l=n[s];0!==a[l]&&(o=!1)}o&&(c.splice(t--,1),e=r(r.s=n[0]))}return e}var o={},a={app:0},c=[];function r(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var i=0;i<s.length;i++)t(s[i]);var u=l;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"0215":function(e,t,n){},"21ae":function(e,t,n){},"2d7c":function(e,t,n){},"3b0e":function(e,t,n){"use strict";n("2d7c")},"3dc3":function(e,t,n){},b093:function(e,t,n){"use strict";n("21ae")},c3b0:function(e,t,n){"use strict";n("3dc3")},c3b1:function(e,t,n){"use strict";n("0215")},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23");function a(e,t,n,a,c,r){var s=Object(o["o"])("Home");return Object(o["j"])(),Object(o["d"])("main",null,[Object(o["f"])(s)])}function c(e,t,n,a,c,r){var s=Object(o["o"])("ToneDashboard");return Object(o["j"])(),Object(o["c"])(s)}var r={class:"notes-in-key-mode"},s={key:1,class:"start-container"};function l(e,t,n,a,c,l){var i=Object(o["o"])("ToneControls"),u=Object(o["o"])("MainPiano"),d=Object(o["o"])("PianoDisplay");return e.$store.state.toneReady?(Object(o["j"])(),Object(o["d"])(o["a"],{key:0},[Object(o["f"])(i),Object(o["f"])(u),Object(o["f"])(d),Object(o["e"])("div",r,[(Object(o["j"])(!0),Object(o["d"])(o["a"],null,Object(o["n"])(e.$store.state.notesInKeyMode,(function(t,n){return Object(o["j"])(),Object(o["d"])("span",{key:n,class:Object(o["i"])(e.noteClass(t))},Object(o["p"])(t),3)})),128))])],64)):(Object(o["j"])(),Object(o["d"])("div",s,[Object(o["e"])("button",{class:"btn salmon btn-init-tone",onClick:t[0]||(t[0]=function(){return e.initTone&&e.initTone.apply(e,arguments)})}," Start ")]))}var i=n("1da1"),u=(n("a15b"),n("96cf"),n("5e54")),d=n("3835");n("d81d");function b(e,t){return Math.floor(Math.random()*(t-e)+e)}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return b(e,t)/t}n("5db7"),n("73d9"),n("d3b7");var j=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],O={ionian:[0,2,4,5,7,9,11],dorian:[0,2,3,5,7,9,10],phrygian:[0,1,3,5,7,8,10],lydian:[0,2,4,6,7,9,11],mixolydian:[0,2,4,5,7,9,10],aeolian:[0,2,3,5,7,8,10],locrian:[0,1,3,5,6,8,10]},f=[{value:"1n",weight:2},{value:"2n",weight:2},{value:"4n",weight:3},{value:"8n",weight:2},{value:"16n",weight:1},{value:"32n",weight:1}],y=f.flatMap((function(e){for(var t=[],n=0;n<e.weight;n++)t.push(e.value);return t}));function m(){var e=b(0,y.length);return y[e]}function v(e,t){var n=j.indexOf(e),o=O[t],a=o.map((function(e){return j[(n+e)%j.length]}));return console.log(a),a}function h(e,t){var n=(t+2)%e.length,o=b(3,6);return[n,e[n]+o]}function g(){var e=C.state.notesInKeyMode,t=b(3,6),n=b(0,e.length),o=e[n]+t;if(Math.random()>.9)return[o];var a=h(e,n),c=Object(d["a"])(a,2),r=c[0],s=c[1];if(Math.random()>.9)return[o,s];var l=h(e,r),i=Object(d["a"])(l,2),u=i[0],p=i[1],j=[o,s,p],O=h(e,u),f=Object(d["a"])(O,2),y=f[0],m=f[1];if(Math.random()>.75&&j.push(m),Math.random()>.9){var v=h(e,y),g=Object(d["a"])(v,2),k=g[1];j.push(k)}return j}function k(){var e=C.state.notesInKeyMode,t=b(3,7),n=b(0,e.length),o=e[n]+t;return o}var T=n("5502"),C=Object(T["a"])({state:{toneReady:!1,samplesReady:!1,volume:new u["Volume"](-12).toDestination(),key:"C",mode:"ionian",notesInKeyMode:["C","D","E","F","G","A","B"],lastPlayedNote:"C4",lastPlayedChord:[]},mutations:{SET_TONE_READY:function(e){e.toneReady=!0},RESET_TONE:function(e){e.toneReady=!1},CHANGE_KEY:function(e,t){e.key=t},CHANGE_MODE:function(e,t){e.mode=t},UPDATE_NOTES:function(e){e.notesInKeyMode=v(e.key,e.mode)}},actions:{changeKey:function(e,t){var n=e.commit;n("CHANGE_KEY",t),n("UPDATE_NOTES")},changeMode:function(e,t){var n=e.commit;n("CHANGE_MODE",t),n("UPDATE_NOTES")}},modules:{}}),A={key:1};function w(e,t,n,a,c,r){var s=Object(o["o"])("PlayButton");return e.$store.state.samplesReady?(Object(o["j"])(),Object(o["c"])(s,{key:0,onClick:e.togglePlaying},null,8,["onClick"])):(Object(o["j"])(),Object(o["d"])("span",A,"Loading samples..."))}function P(e){var t=k(),n=m(),o=p();u["Transport"].scheduleOnce((function(){e.triggerAttackRelease(t,n,"+0",o),C.state.lastPlayedNote=t}),"+0"),E(e)}function M(e){var t=g(),n=p();u["Transport"].scheduleOnce((function(){e.triggerAttackRelease(t,"1n","+0",n),C.state.lastPlayedChord=t}),"+0"),_(e)}function E(e){var t=m();u["Transport"].scheduleOnce((function(t){var n=k(),o=m(),a=p();e.triggerAttackRelease(n,o,t,a),C.state.lastPlayedNote=n,E(e)}),"+".concat(t))}function _(e){var t=Math.random()>.25?"1n":Math.random()>.25?"2n":"4n";u["Transport"].scheduleOnce((function(n){var o=g(),a=p();e.triggerAttackRelease(o,t,n,a),C.state.lastPlayedChord=o,_(e)}),"+".concat(t))}var D={key:0,class:"stop-icon"},R={key:1,class:"play-icon"};function S(e,t,n,a,c,r){return Object(o["j"])(),Object(o["d"])("button",{class:"play-button",onClick:t[0]||(t[0]=function(){return e.toggleIcon&&e.toggleIcon.apply(e,arguments)})},[e.playing?(Object(o["j"])(),Object(o["d"])("span",D,"â– ")):(Object(o["j"])(),Object(o["d"])("span",R,"â–·"))])}var N=Object(o["g"])({name:"PlayButton",data:function(){return{playing:!1}},methods:{toggleIcon:function(){this.playing=!this.playing}}}),x=(n("3b0e"),n("6b0d")),I=n.n(x);const K=I()(N,[["render",S],["__scopeId","data-v-25fb78ee"]]);var $=K,G=Object(o["g"])({name:"MainPiano",components:{PlayButton:$},mounted:function(){u["Transport"].stop(),u["Transport"].bpm.value=100;var e=new u["Volume"](-12).toDestination();this.$store.commit("SET_VOLUME",e);var t=new u["Sampler"]({urls:{A1:"/samples/A1.mp3",A2:"/samples/A2.mp3",A3:"/samples/A3.mp3",A4:"/samples/A4.mp3",A5:"/samples/A5.mp3",A6:"/samples/A6.mp3",A7:"/samples/A7.mp3"},release:20,onload:function(){C.state.samplesReady=!0,u["Transport"].cancel(),P(t),M(t)},onerror:function(e){console.error("Failed to load samples - ",e)}}).connect(e),n=new u["Reverb"]({wet:1,decay:10,preDelay:.013}).connect(e);t.connect(n),C.state.notesInKeyMode=v(C.state.key,C.state.mode)},data:function(){return{playing:!1}},methods:{togglePlaying:function(){this.playing?u["Transport"].pause():u["Transport"].start(),this.playing=!this.playing}}});const F=I()(G,[["render",w]]);var H=F,B=["value","selected"],U=["value","selected"],V={class:"d-flex justify-center align-center"},Y=Object(o["e"])("span",null,"ðŸ”ˆ",-1),J=Object(o["e"])("span",null,"ðŸ”Š",-1);function L(e,t,n,a,c,r){return Object(o["j"])(),Object(o["d"])(o["a"],null,[Object(o["e"])("select",{onChange:t[0]||(t[0]=function(t){return e.updateSelectedKey(t)})},[(Object(o["j"])(!0),Object(o["d"])(o["a"],null,Object(o["n"])(e.noteTable,(function(t,n){return Object(o["j"])(),Object(o["d"])("option",{key:n,value:t,selected:t===e.$store.state.key},Object(o["p"])(t),9,B)})),128))],32),Object(o["e"])("select",{onChange:t[1]||(t[1]=function(t){return e.updateSelectedMode(t)})},[(Object(o["j"])(!0),Object(o["d"])(o["a"],null,Object(o["n"])(e.modesTable,(function(t,n,a){return Object(o["j"])(),Object(o["d"])("option",{key:a,value:n,selected:n===e.$store.state.mode},Object(o["p"])(n),9,U)})),128))],32),Object(o["e"])("div",V,[Y,Object(o["s"])(Object(o["e"])("input",{type:"range","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.$store.state.volume.volume.value=t}),min:"-60",max:"0",step:"0.1"},null,512),[[o["q"],e.$store.state.volume.volume.value]]),J]),Object(o["e"])("p",null,Object(o["p"])(e.transportTime)+"s",1)],64)}n("b680");var q=Object(o["g"])({name:"ToneControls",setup:function(){return{noteTable:j,modesTable:O}},data:function(){return{transportTime:"0"}},mounted:function(){var e=this;setInterval((function(){e.transportTime=u["Transport"].seconds.toFixed(0)}),100)},methods:{updateSelectedKey:function(e){var t=e.target;C.dispatch("changeKey",t.value)},updateSelectedMode:function(e){var t=e.target;C.dispatch("changeMode",t.value)}}});const z=I()(q,[["render",L]]);var Q=z;function W(e,t,n,a,c,r){return Object(o["j"])(),Object(o["d"])("div",{class:Object(o["i"])(["piano-display",{loading:!e.$store.state.samplesReady}])},[(Object(o["j"])(),Object(o["d"])(o["a"],null,Object(o["n"])(5,(function(t){return Object(o["e"])("div",{class:"piano-octave",key:t},[Object(o["e"])("span",{class:Object(o["i"])(["white-key",e.noteColor("C"+(t+2))])}," C"+Object(o["p"])(t+2),3),Object(o["e"])("span",{class:Object(o["i"])(["black-key",e.noteColor("C#"+(t+2))])},null,2),Object(o["e"])("span",{class:Object(o["i"])(["white-key",e.noteColor("D"+(t+2))])},null,2),Object(o["e"])("span",{class:Object(o["i"])(["black-key",e.noteColor("D#"+(t+2))])},null,2),Object(o["e"])("span",{class:Object(o["i"])(["white-key",e.noteColor("E"+(t+2))])},null,2),Object(o["e"])("span",{class:Object(o["i"])(["white-key",e.noteColor("F"+(t+2))])},null,2),Object(o["e"])("span",{class:Object(o["i"])(["black-key",e.noteColor("F#"+(t+2))])},null,2),Object(o["e"])("span",{class:Object(o["i"])(["white-key",e.noteColor("G"+(t+2))])},null,2),Object(o["e"])("span",{class:Object(o["i"])(["black-key",e.noteColor("G#"+(t+2))])},null,2),Object(o["e"])("span",{class:Object(o["i"])(["white-key",e.noteColor("A"+(t+2))])},null,2),Object(o["e"])("span",{class:Object(o["i"])(["black-key",e.noteColor("A#"+(t+2))])},null,2),Object(o["e"])("span",{class:Object(o["i"])(["white-key",e.noteColor("B"+(t+2))])},null,2)])})),64))],2)}n("caad"),n("2532");var X=Object(o["g"])({name:"PianoDisplay",methods:{noteColor:function(e){var t=C.state.notesInKeyMode.join(),n=C.state.lastPlayedChord.join(),o=e.substring(0,e.length-1);return{"in-key-mode":t.includes(o),"played-note":C.state.lastPlayedNote==e,"in-chord":n.includes(e)}}}});n("c3b1");const Z=I()(X,[["render",W],["__scopeId","data-v-7d366ae8"]]);var ee=Z,te=Object(o["g"])({name:"ToneDashboard",components:{MainPiano:H,ToneControls:Q,PianoDisplay:ee},setup:function(){return{noteTable:j,modesTable:O,Tone:u}},methods:{initTone:function(){return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u["start"]();case 2:C.commit("SET_TONE_READY");case 3:case"end":return e.stop()}}),e)})))()},noteClass:function(e){var t=this.$store.state.lastPlayedNote;return{"last-note":e==t.substring(0,t.length-1),"in-chord":-1!=this.$store.state.lastPlayedChord.join().indexOf(e)}}}});n("b093");const ne=I()(te,[["render",l]]);var oe=ne,ae=Object(o["g"])({name:"Home",components:{ToneDashboard:oe}});const ce=I()(ae,[["render",c]]);var re=ce,se=Object(o["g"])({name:"App",components:{Home:re}});n("c3b0");const le=I()(se,[["render",a]]);var ie=le;Object(o["b"])(ie).use(C).mount("#app")}});
//# sourceMappingURL=app.465750a7.js.map